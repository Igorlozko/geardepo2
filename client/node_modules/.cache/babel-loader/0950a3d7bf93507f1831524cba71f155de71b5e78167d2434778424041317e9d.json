{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\igorl\\\\Downloads\\\\place-to-stay-part2\\\\client\\\\src\\\\components\\\\user\\\\GoogleOneTapLogin.js\",\n  _s = $RefreshSig$();\nimport { Google } from '@mui/icons-material';\nimport { Button } from '@mui/material';\nimport React, { useState, useEffect } from 'react';\nimport { useValue } from '../../context/ContextProvider';\nimport { jwtDecode } from 'jwt-decode';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GoogleOneTapLogin = () => {\n  _s();\n  const {\n    dispatch\n  } = useValue();\n  const [disabled, setDisabled] = useState(false);\n  useEffect(() => {\n    if (window.google && window.google.accounts && window.google.accounts.id) {\n      console.log('Google One Tap library is available.');\n    } else {\n      console.error('Google One Tap library not available.'); //\n    }\n  }, []);\n  const handleResponse = response => {\n    const token = response.credential;\n    const decodedToken = jwtDecode(token);\n    console.log(decodedToken);\n    const {\n      sub: id,\n      email,\n      name,\n      picture: photoURL\n    } = decodedToken;\n    dispatch({\n      type: 'UPDATE_USER',\n      payload: {\n        id,\n        email,\n        name,\n        photoURL,\n        token,\n        google: true\n      }\n    });\n    dispatch({\n      type: 'CLOSE_LOGIN'\n    });\n  };\n  const handleGoogleLogin = () => {\n    setDisabled(true);\n    try {\n      window.google.accounts.id.initialize({\n        client_id: process.env.REACT_APP_GOOGLE_CLIENT_ID,\n        callback: handleResponse\n      });\n      window.google.accounts.id.prompt(notification => {\n        if (notification.isNotDisplayed()) {\n          // Check for isNotDisplayed property\n          throw new Error('Try to clear the cookies and try again');\n        }\n        if (notification.isSkippedMoment() || notification.isDismissedMoment()) {\n          setDisabled(false);\n        }\n      });\n    } catch (error) {\n      dispatch({\n        type: 'UPDATE_ALERT',\n        payload: {\n          open: true,\n          severity: 'error',\n          message: error.message\n        }\n      });\n      console.error(error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Button, {\n    variant: \"outlined\",\n    startIcon: /*#__PURE__*/_jsxDEV(Google, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 43\n    }, this),\n    disabled: disabled,\n    onClick: handleGoogleLogin,\n    children: \"Login with Google\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n};\n_s(GoogleOneTapLogin, \"LAOQFFBMHtKbfOIkhdpcMdoY+js=\", false, function () {\n  return [useValue];\n});\n_c = GoogleOneTapLogin;\nexport default GoogleOneTapLogin;\nvar _c;\n$RefreshReg$(_c, \"GoogleOneTapLogin\");","map":{"version":3,"names":["Google","Button","React","useState","useEffect","useValue","jwtDecode","jsxDEV","_jsxDEV","GoogleOneTapLogin","_s","dispatch","disabled","setDisabled","window","google","accounts","id","console","log","error","handleResponse","response","token","credential","decodedToken","sub","email","name","picture","photoURL","type","payload","handleGoogleLogin","initialize","client_id","process","env","REACT_APP_GOOGLE_CLIENT_ID","callback","prompt","notification","isNotDisplayed","Error","isSkippedMoment","isDismissedMoment","open","severity","message","variant","startIcon","fileName","_jsxFileName","lineNumber","columnNumber","onClick","children","_c","$RefreshReg$"],"sources":["C:/Users/igorl/Downloads/place-to-stay-part2/client/src/components/user/GoogleOneTapLogin.js"],"sourcesContent":["import { Google } from '@mui/icons-material';\nimport { Button } from '@mui/material';\nimport React, { useState, useEffect } from 'react';\nimport { useValue } from '../../context/ContextProvider';\nimport {jwtDecode} from 'jwt-decode';\n\nconst GoogleOneTapLogin = () => {\n  const { dispatch } = useValue();\n  const [disabled, setDisabled] = useState(false);\n\n  useEffect(() => {\n    if (window.google && window.google.accounts && window.google.accounts.id) {\n      console.log('Google One Tap library is available.');\n    } else {\n      console.error('Google One Tap library not available.');//\n    }\n  }, []);\n\n  const handleResponse = (response) => {\n    const token = response.credential;\n    const decodedToken = jwtDecode(token);\n    console.log(decodedToken);\n    const {sub: id, email, name, picture:photoURL } = decodedToken\n    dispatch({type:'UPDATE_USER', payload:{id, email,name,photoURL, token, google:true}})\n    dispatch({type:'CLOSE_LOGIN'})\n  };\n\n  const handleGoogleLogin = () => {\n    setDisabled(true);\n    try {\n        window.google.accounts.id.initialize({\n          client_id: process.env.REACT_APP_GOOGLE_CLIENT_ID,\n          callback: handleResponse,\n        });\n  \n        window.google.accounts.id.prompt((notification) => {\n          if (notification.isNotDisplayed()) {  // Check for isNotDisplayed property\n            throw new Error('Try to clear the cookies and try again');\n          }\n          if (notification.isSkippedMoment() || notification.isDismissedMoment()) {\n            setDisabled(false);\n          }\n        });\n    } catch (error) {\n      dispatch({ type: 'UPDATE_ALERT', payload: { open: true, severity: 'error', message: error.message },\n     });\n      console.error(error);\n    }\n  };\n\n  return (\n    <Button variant=\"outlined\" startIcon={<Google />} disabled={disabled} onClick={handleGoogleLogin}>\n      Login with Google\n    </Button>\n  );\n};\n\nexport default GoogleOneTapLogin;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}